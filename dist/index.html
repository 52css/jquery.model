<!doctype html><html><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1.0,user-scalable=no"><title>单页面切换</title><link rel=stylesheet href=less/main.min.css><link rel=stylesheet href=css/font-awesome.min.css></head><body id=body><div class=status-bar></div><div class=status-body><div id=left class="left layout-dark theme-white" vm-class="{'open-left': data.show}"><div class=view><div id=left1 class="page out"><header class=header></header><div class=content>this is left <a href=#!/page1 class=btn>go page 1</a></div></div></div></div><div id=right class="right layout-dark" vm-class="{'open-right': data.show}"><div class=view><div id=right1 class="page out"><header class=header></header><div class=content>this is right1 <a href=#!/right2 class=btn>right2</a> <a href=#!/right3 class=btn>right3</a></div><footer class=footer></footer></div><div id=right2 class="page out"><header class=header></header><div class=content>this is right2 <a href=javascript:history.back(); class=btn>right1</a></div><footer class=footer></footer></div><div id=right3 class="page out"><header class=header></header><div class=content>this is right3 <a href=javascript:history.back(); class=btn>right1</a></div><footer class=footer></footer></div></div></div><div class=main><div id=top class=top vm-class="{'open-top': !!data.show}"><div class=top-in>{{data.content}}</div></div><div class=view><div id=pageHome class="page out" data-title="this is pageHome"><header class=header><div class=header-left></div><div class=header-center><h1 class=header-center-in>framework</h1></div><div class=header-right><a class=open-Left>Menu</a></div></header><div class=content><div class=wrapper><div class=scroller><section class="box box-xl"><div class=box-in>all eg: <a href=about.html class=btn>关于我们</a></div><ul class=list><li><a href=dialog.html class=list-content><div class=list-inner><div class=list-title>Dialog</div><div class=list-after><i class="fa fa-lg fa-angle-right"></i></div></div></a></li><li><a href=tab.html class=list-content><div class=list-inner><div class=list-title>Tab</div><div class=list-after><i class="fa fa-lg fa-angle-right"></i></div></div></a></li><li><a href=side-panels.html class=list-content><div class=list-inner><div class=list-title>Side Panels</div><div class=list-after><i class="fa fa-lg fa-angle-right"></i></div></div></a></li><li><a href=btn.html class=list-content><div class=list-inner><div class=list-title>Btn</div><div class=list-after><i class="fa fa-lg fa-angle-right"></i></div></div></a></li><li><a href=grid.html class=list-content><div class=list-inner><div class=list-title>Grid</div><div class=list-after><i class="fa fa-lg fa-angle-right"></i></div></div></a></li><li><a href=list.html class=list-content><div class=list-inner><div class=list-title>List</div><div class=list-after><i class="fa fa-lg fa-angle-right"></i></div></div></a></li><li><a href=badge.html class=list-content><div class=list-inner><div class=list-title>Badge</div><div class=list-after><i class="fa fa-lg fa-angle-right"></i></div></div></a></li><li><a href=theme.html class=list-content><div class=list-inner><div class=list-title>Theme</div><div class=list-after><i class="fa fa-lg fa-angle-right"></i></div></div></a></li><li><a href=form-smart-select.html class=list-content><div class=list-inner><div class=list-title>Smart Select</div><div class=list-after><i class="fa fa-lg fa-angle-right"></i></div></div></a></li></ul></section></div></div></div></div><div id=page1 class="page out"><header class=header><div class=header-left><a class=open-left>Left</a></div><div class=header-center><h1 class=header-center-in>framework</h1></div><div class=header-right><a class=open-right>right</a></div></header><div class=content><div class=wrapper><div class=scoller>this page 1 <a href=javascript:history.back(); class=btn>back</a></div></div></div></div><div id=smart-select class="smart-select page out"><header class=header><div class=header-left><a href=javascript:history.back(); class="btn btn-link"><i class="fa fa-lg fa-chevron-left"></i> Back</a></div><div class=header-center><h1 class=header-center-in>{{title}}</h1></div><div class=header-right></div></header><div class=content><div class=wrapper><div class=scoller><section class="box box-xl"><ul class=list><li vm-repeat=list vm-class="{'li-selected': $item.selected, 'li-multiple': style == 'multiple', 'list-divider': $item.divider}" vm-data="{'id': $item.id}"><div vm-if=$item.divider>{{$item.divider}}</div><a class=list-content vm-else=""><div class=list-media><i class="fa fa-2x fa-circle-thin color-gray"></i> <i class="fa fa-2x fa-check-circle theme-highlight-color"></i></div><div class=list-inner><div class=list-title>{{$item.text}}</div><div class=list-after><i class="fa fa-check theme-highlight-color"></i></div></div></a></li></ul></section></div></div></div></div></div><div id=bottom class=bottom vm-class="{'open-bottom': data.show}"><div class=in><header class=header><div class=header-center><h1 class=header-center-in>open bottom</h1></div><div class=header-right><a class=close-bottom>done</a></div></header><div class=content><div vm-if=data.content>{{data.content}}</div><div vm-else="">Integer mollis nulla id nibh elementum finibus. Maecenas eget fermentum ipsum. Sed sagittis condimentum nisl at tempus. Duis lacus libero, laoreet vitae ligula a, aliquet eleifend sapien. Nullam sodales viverra sodales. Nulla hendrerit condimentum dolor facilisis tempor. Donec at est malesuada, sagittis nisi et, accumsan enim.</div></div></div></div></div><div id=mask class=mask vm-class="{'open-mask':data.show, 'mask-white': !data.black, 'mask-black': data.black}"></div><div id=indicator class=indicator vm-class="{'open-indicator': data.show}"><div class=indicator-in><i class="fa fa-spinner fa-pulse fa-2x"></i></div></div><div id=modal><div class=alert vm-repeat=data><div class=alert-in><div class=alert-title>{{$item.title || 'Framework'}}</div><div class=alert-content>{{$item.content | html}}</div><div class=alert-btn><a class="btn btn-link" vm-repeat=$item.btn>{{$item1.text}}</a></div></div></div></div><div id=bottomBtn class=bottom-btn vm-class="{'open-bottom-btn': data.show}"><div class=bottom-btn-in><ul class="list list-inset"><li><div class=list-content><div class=list-inner><div class=list-title>Here comes some optional description or warning for actions below</div></div></div></li><li><a class="list-content btn btn-link"><div class=list-inner><div class=list-title>Ivan Petrov</div></div></a></li><li><a class="list-content btn btn-link color-red"><div class=list-inner><div class=list-title>Ivan Petrov</div></div></a></li></ul><ul class="list list-inset"><li><a class="list-content btn btn-link"><div class=list-inner><div class=list-title>Cancel</div></div></a></li></ul></div></div></div><script src=./js/lib/require.js></script><script>
  // open-left open-right open-bottom open-top open-popup open-modal open-loading
</script><script>
//  require(['./js/lib/jquery', './js/lib/jquery.dim'], function($) {
//    $.dim('test', ['app'], function() {
//      debugger;
//    });
//  });

  require(['./js/lib/jquery', './js/lib/jquery.model'], function($) {

    $.dim('appInit', ['app'], function(r, exports, module) {
      var
        self = this,
        app = r('app'),
        mc = function(model, ctrl) {
          ctrl && $.each(ctrl, function(i, n) {
            n && n.call(self, model);
          });
          return model;
        };

      module.exports = mc({}, {
        pageHome: function() {
          var i = 0;
          app
            .on('pageFirstInit', 'pageHome', function() {
              $.dim('pageHome', {
                page: 'pageHome'
              });
            })
            .on('pageInit', 'pageHome', function() {
              $.dim(['pageHome'], function(r, exports, module) {
                var page = r('pageHome');
                page.page = 'pageHome' + (++ i);
                console.log(page.page);
              });
            });
        },
        theme: function() {
          app
            .on('pageFirstInit', 'theme', function(page) {
              $.dim('theme', function(r, exports, module) {
                var
                  self = this,
                  mc = function(model, ctrl) {
                    ctrl && $.each(ctrl, function(i, n) {
                      n && n.call(self, model);
                    });
                    return model;
                  };

                module.exports = mc({
                }, {
                  click: function() {
                    ['layout', 'theme'].forEach(function(actionName) {
                      [].slice.call(page.querySelectorAll('[data-' + actionName + ']')).forEach(function(node) {
                        var className = node.getAttribute('data-' + actionName + '');
                        node.addEventListener('click', function() {
                          [].slice.call(body.classList).forEach(function(className) {
                            if (new RegExp('^' + actionName + '\\-').test(className)) {
                              body.classList.remove(className);
                            }
                          });
                          body.classList.add('' + actionName + '-' + className);
                        }, false);
                      });
                    });
                  }
                });
              });
            });
        },
        dialog: function() {
          app
            .on('pageFirstInit', 'dialog', function(page) {
              $.dim('dialog', function(r, exports, module) {
                var
                  self = this,
                  mc = function(model, ctrl) {
                    ctrl && $.each(ctrl, function(i, n) {
                      n && n.call(self, model);
                    });
                    return model;
                  };

                module.exports = mc({
                  list: ['open-alert', 'open-alert-callback', 'open-mulit-alert', 'open-mulit-alert-callback', 'open-confirm', 'open-confirm-ok', 'open-indicator', 'open-preloader', 'open-preloader2', 'open-bottom-btn'] //'open-left', 'open-right'
                }, {
                  openLeft: function() {
                    $(this).on('click', '.open-left', function() {
                      if (!app.isShowLeft()) {
                        app.showLeft();
                        return false;
                      }
                    });
                  },
                  openRight: function() {
                    $(this).on('click', '.open-right', function() {
                      if (!app.isShowRight()) {
                        app.showRight();
                        return false;
                      }
                    });
                  },
                  openTop: function() {
                    $(this).on('click', '.open-top', function() {
                      app.showTop('aaaa');
                      return false;
                    });
                  },
                  openBottom: function() {
                    $(this).on('click', '.open-bottom', function() {
                      app.showBottom();
                      return false;
                    });
                  },
                  openAlert: function() {
                    $(this).on('click', '.open-alert', function() {
                      app.alert('my app', 'test111');
                      return false;
                    });
                  },
                  openAlertCallback: function() {
                    $(this).on('click', '.open-alert-callback', function() {
                      app.alert('my app', 'test222', function() {
                        alert(222);
                      });
                      return false;
                    });
                  },
                  openMulitAlert: function() {
                    $(this).on('click', '.open-mulit-alert', function() {
                      app.alert('my app', 'test333');

                      app.alert('my app', 'test444');

                      app.alert('my app', 'test555');
                      return false;
                    });
                  },
                  openMulitAlertCallback: function() {
                    $(this).on('click', '.open-mulit-alert-callback', function() {
                      app.alert('my app', 'test666', function() {
                        alert(666);
                      });

                      app.alert('my app', 'test777');

                      app.alert('my app', 'test888', function() {
                        alert(888);
                      });
                      return false;
                    });
                  },
                  openConfirm: function() {
                    $(this).on('click', '.open-confirm', function() {
                      app.confirm('my app', 'test999');
                      return false;
                    });
                  },
                  openConfirmOk: function() {
                    $(this).on('click', '.open-confirm-ok', function() {
                      app.confirm('my app', 'test999', function() {
                        alert('ok');
                      });
                      return false;
                    });
                  },
                  openIndicator: function() {
                    $(this).on('click', '.open-indicator', function() {
                      app.showIndicator();
                      setTimeout(function() {
                        app.hideIndicator();
                      }, 3000);
                      return false;
                    })
                  },
                  openPreloader: function() {
                    $(this).on('click', '.open-preloader', function() {
                      app.showPreloader();
                      setTimeout(function() {
                        app.hidePreloader();
                      }, 10000);
                      return false;
                    })
                  },
                  openPreloader2: function() {
                    $(this).on('click', '.open-preloader2', function() {
                      app.showPreloader2('My Text');
                      setTimeout(function() {
                        app.hidePreloader();
                      }, 10000);
                      return false;
                    })
                  },
                  openBottomBtn: function() {
                    $(this).on('click', '.open-bottom-btn', function() {
                      app.showBottomBtn();
                      return false;
                    })
                  }
                });
              });
            });
        },
        init: function() {
          app
            .on('pageFirstInit', 'smart-select', function(page, state) {
              $.dim('smart-select', function(r, exports, module) {
                var
                  self = this,
                  mc = function(model, ctrl) {
                    ctrl && $.each(ctrl, function(i, n) {
                      n && n.call(self, model);
                    });
                    return model;
                  };

                module.exports = mc({
                  title: 'smart select',
                  style: 'multiple',
                  list: []
                }, {
                  liClick: function() {
                    $(this).on('click', 'li', function() {
                      var
                        id = $(this).data('id'),
                        $select = $('#' + id),
                        index = $(this).parent().find('li:not(.list-divider)').index(this);

                      if ($select.attr('multiple')) {
                        $(this).toggleClass('li-selected');
                      } else {
                        $(this).addClass('li-selected').siblings().removeClass('li-selected');
                      }
                      $select.find('option').eq(index).prop('selected', $(this).hasClass('li-selected'));
                    });
                  }
                });
              });
            })
            .on('pageInit', 'smart-select', function(page, state) {
              var id = state.query.id,
                $select = $('#' + id),
                name = $select.attr('name') || id,
                list = [],
                $optgroup = $select.find('optgroup');

              if ($optgroup && $optgroup.length) {
                $optgroup.each(function() {
                  var label = $(this).attr('label');
                  if (label) {
                    list.push({
                      divider: label,
                      text: '',
                      selected: false,
                      id: id
                    });
                  }
                  $(this).find('option').each(function() {
                    list.push({
                      text: $(this).text(),
                      selected: $(this).is(':selected'),
                      divider: '',
                      id: id
                    });
                  });
                });
              } else {
                $select.find('option').each(function() {
                  list.push({
                    text: $(this).text(),
                    selected: $(this).is(':selected'),
                    divider: '',
                    id: id
                  });
                });
              }


              $.dim(['smart-select'], function(r, exports, module) {
                var ss = r('smart-select');
                ss.style = $select.attr('multiple');
                ss.title = name;
                ss.list = list;
              });
            })
            .on('pageInit', function() {
              $('[href^="#!/smart-select?id="]').each(function() {
                var
                  $this = $(this),
                  href = $this.attr('href'),
                  id = app.getState(href).query.id,
                  $select = $('#' + id),
                  name = $select.attr('name') || id,
                  $title = $this.find('.list-title'),
                  $wz = $this.find('.list-wz');

                $title.html(name.replace(/^\w/, function($0) {
                  return $0.toUpperCase();
                }));
                $wz.html($select.find('option:selected').map(function() {
                  return $(this).text()
                }).get().join(', '));

              });
            })
            .init();
        }
      });
    });

/*    $.dim('pageHome', ['app', 'aaaa'], function(r, exports, module) {
      var
        self = this,
        app = r('app'),
        mc = function(model, ctrl) {
          ctrl && $.each(ctrl, function(i, n) {
            n && n.call(self, model);
          });
          return model;
        };

      module.exports = mc({}, {

      });

    });*/

  });
//  require(['./js/lib/mobile', './js/lib/fastclick'], function(mobile, fastclick) {
//    fastclick.attach(document.body);
//    mobile
//      .on('pageFirstInit', 'theme', function(page) {
//        var body = document.body;
//        ['layout', 'theme'].forEach(function(actionName) {
//          [].slice.call(page.querySelectorAll('[data-' + actionName + ']')).forEach(function(node) {
//            var className = node.getAttribute('data-' + actionName + '');
//            node.addEventListener('click', function() {
//              [].slice.call(body.classList).forEach(function(className) {
//                if (new RegExp('^' + actionName + '\\-').test(className)) {
//                  body.classList.remove(className);
//                }
//              });
//              body.classList.add('' + actionName + '-' + className);
//            }, false);
//          });
//        });
//      })
//      .init();
//  });
</script></body></html>