/**
 * Created by kerr on 2015/4/20.
 * Version: 0.0.1
 */!function(){var e=function(e){var t=function(){return function(){var t=[],n=[],i=0,r=function(){t.end&&"function"===e.type(t.end)&&(t.end(),e.each(n,function(e,t){t()}),t.isEnd=!0)};return t.add=function(e){t.push(e)},t.fire=function(n,i){n&&"function"===e.type(n)&&n(),t.end=i,t.length?t.forEach(function(t){t&&"function"===e.type(t)&&t()}):r()},t.onEnd=function(e){t.isEnd?e():n.push(e)},t.ok=function(n,o,a){n&&o&&("object"===e.type(o)?n=e.extend(n,o):a&&(n[o]=a)),i+=1,t.length===i&&r()},t}}(),n={version:"0.0.1",init:function(){var t=this;return t.binds&&e.each(t.binds,function(e,n){n.call(t)}),window.VMODELS={},t},noop:function(){},filters:{html:function(e){}},bindInput:function(e,t){window.addEventListener?e.addEventListener("input",t,!1):(e.attachEvent("onchange",t),e.attachEvent("onkeyup",t),e.attachEvent("onpaste",t)),window.VBArray&&window.addEventListener&&window.attachEvent&&(e.attachEvent("onkeydown",function(){var n=arguments,i=window.event.keyCode;(8===i||46===i)&&t.apply(e,n)}),e.attachEvent("oncut",t)),e.attachEvent&&e.attachEvent("onmouseup",function(n){setTimeout(function(){var n=e.value;""===n&&t()},16)})},binds:{fixArray:function(){e.extend(Array.prototype,{set:function(e,t){return this.splice(e,1,t)},removeAt:function(e){return this.splice(e,0)},indexOf:function(t){return e.inArray(t,this)},unique:function(){for(var e=0,t=this.length,n=[];t>e;e++){var i=this[e];-1===n.indexOf(i)&&n.push(i)}return n},remove:function(e){var t=this.indexOf(e);return this.removeAt(t)},removeAll:function(){return this.splice(0,this.length)},ensure:function(e){return-1===this.indexOf(e)&&this.push(e),this},clear:function(){return this.splice(0,this.length)}})},fixIe678:function(){n.ie678&&(window.ie_model_get_and_set=function(e,t,n,i,r){"$event"!==t&&e&&e.$event&&(n?e.$event.fire2(e,"vbscript.set."+t,[i,r]):e.$event.fire2(e,"vbscript.get."+t))})}},Event:function(){var t=function(){this.events={}};return t.prototype={constructor:this,add:function(t,n){var i=this;e.each(t.split(" "),function(e,t){i[t]||(i[t]=[]);for(var r=0,o=i[t].length;o>r;r++)if(i[t][r]===n)return!1;i[t].push(n)})},fire:function(e){this.fire2(this,e,Array.prototype.slice.call(arguments).slice(1))},fire2:function(t,n,i){var r=this;e.each(n.split(" "),function(e,n){if(r[n])for(var o=0,a=r[n].length;a>o;o++)r[n][o].apply(t||r,i||[])})}},t}(),ie678:!window.dispatchEvent,re:/\{\{(.+?)\}\}/g,prefix:"vm-",hasGet:[],addProperty:function(e,t,i,r){var o=e[t],a=function(){return i.apply(e,[o])},c=function(t){return o=r.apply(e,[t,o])};e.$event.add("fix.set."+t,r),n.ie678?(e.$event.add("vbscript.get."+t,i),e.$event.add("vbscript.set."+t,r)):Object.defineProperty?Object.defineProperty(e,t,{get:a,set:c}):e.__defineGetter__&&(e.__defineGetter__(t,a),e.__defineSetter__(t,c))},addProp:function(e,t,i,r){n.addProperty(e,t,function(){return this.$event&&this.$event.fire("get",t,this),i?i.call(e):this["$"+t]},function(e,i){r&&r.apply(this,arguments),this.$event&&e!==i&&this.$event.fire("watch."+t,e,i,this),n.ie678?this[t]!==e&&(this[t]=e):this["$"+t]!==e&&(this["$"+t]=e),this.$event&&this.$event.fire("set."+t,t,e,this)})},createEventAdd:function(t,i,r,o,a){n.hasGet=[],new Function("vm","var rtv; with(vm) { rtv = "+i+"; } return rtv;")(t);var c=[].concat(n.hasGet);o&&"function"===e.type(o)&&o(c);var f=function(t,n,o){var a=[],f=[],u=c.length;1===u&&t&&n?(a.push(t),f.push(n)):e.each(c,function(e,t){a.push(t.key),f.push(t.obj[t.key])}),a.push("return "+i+";");var s=Function.apply(null,a).apply(null,f);r(s,c)};e.each(a?c.slice(0,1):c,function(e,t){/^\$/.test(t.key)||t.obj&&t.obj.$event&&t.obj.$event.add("set."+t.key,f)}),f()},deelNode:function(t,i,r){var o=e(t);if(3===t.nodeType){var a,c=e.trim(o.text()),f=c.length,u=0,s=function(t,n){var i,r=/\|\s*html\s*/,a=e("<!-- html start -->"),c=e("<!-- html end -->");r.test(t)?"function"===e.type(n)&&(o.before(a).after(c).remove(),n(t.replace(r,""),a,c)):(i=document.createTextNode(t),o.before(i),"function"===e.type(n)&&n(t,i))};if(/\{\{(.+?)\}\}/.test(c)){for(t.nodeValue="";null!=(a=n.re.exec(c));)u<a.index&&s(c.slice(u,a.index)),s(a[1],function(t,o,a){if(r&&/^\$item/.test(t)&&r[t]){var c=[];n.createEventAdd(r.repeatObj,r[t],function(t){if(a){var n=document.createElement("div");for(n.innerHTML=t,e.each(c,function(t,n){e(n).remove()});n.firstChild;)c[c.length-1]=n.firstChild,a.before(n.firstChild)}else o.nodeValue=t})}var f=[];n.createEventAdd(i,t,function(t){if(a){var n=document.createElement("div");for(n.innerHTML=t,e.each(f,function(t,n){e(n).remove()});n.firstChild;)f[f.length-1]=n.firstChild,a.before(n.firstChild)}else o.nodeValue=t})}),u=a.index+a[0].length;f>u&&s(c.slice(u,f))}}else e.each(n.attrs,function(e,t){var r=o.attr(n.prefix+e);r&&t(o,i,r)})},attrs:function(){var t={"class":function(t,i,r){n.createEventAdd(i,r,function(n){e.each(n,function(e,n){n?t.addClass(e):t.removeClass(e)})})},classlist:function(e,t,i){n.createEventAdd(t,i,function(t){e.addClass(t)})},attr:function(t,i,r){n.createEventAdd(i,r,function(n){e.each(n,function(e,n){t.attr(e,n)})})},prop:function(t,i,r){n.createEventAdd(i,r,function(n){e.each(n,function(e,n){t.prop(e,n)})})},css:function(t,i,r){n.createEventAdd(i,r,function(n){e.each(n,function(e,n){t.css(e,n)})})},"if":function(e,t,i){n.createEventAdd(t,i,function(t){var i=e.siblings("["+n.prefix+"else]");e[t?"show":"hide"](),i.length&&i[t?"hide":"show"]()})},duplex:function(e,t,i){n.createEventAdd(t,i,function(t){e.val()!==t&&e.val(t)},function(){n.bindInput(e.get(0),function(n){e.val()!==t[i]&&(t[i]=e.val())})},!0)},data:function(e,t,i){n.createEventAdd(t,i,function(t){e.data(t)})},value:function(e,t,i){n.createEventAdd(t,i,function(t){e.val(t)})}};return e.each("click change".split(" "),function(e,n){t[n]=function(e,t,i){e.on(n,function(){return new Function("vm","var rtv; with(vm) { rtv = "+i+"; } return rtv;").call(this,t)})}}),t}(),deelRepeat:function(t,i,r,o){var a=e(t),c=a.attr(n.prefix+"repeat").split(":"),f=c[0],u=!!c[1],s=e("<!-- repeat start -->"),d=e("<!-- repeat end -->"),l=a.clone().removeAttr(n.prefix+"repeat"),h=[];r=r||"",a.before(s).after(d).remove(),n.createEventAdd(i,f,function(t){if("array"===e.type(t)){n.arrayBindEvent(t);var a=t.$event||new n.Event,c=new n.Event;return c.add("delete",function(e,t,n,i){var r=h.length,o=e,a=Math.min(e+t,r);if(u){if(e>=0&&r>e){for(;r>o;o++)h[o].remove();h.splice(e,r),n&&i&&c.fire("insert",e,i.slice(e))}}else if(e>=0){for(;a>o;o++)h[o].remove();h.splice(e,t)}}),c.add("insert",function(t,a){var c=h[t]||d,f=h.length;e.each(a,function(e,a){var u=l.clone(),s=i;s["$item"+r]=a,s["$index"+r]=f+e,h.splice(t+e,0,u),n.deelNode(u,s,o),c.before(u),n.getChildNodes(u,s,r+1,o)})}),a.add("index",function(e,t){n.deelNode(e,t)}),a.add("splice",function(e,t,n){var i=e[0],r=e[1],o=[].slice.call(e,2);c.fire("delete",i,r,t,n),c.fire("insert",i,o)}),a.add("push",function(e,t,n){c.fire("insert",h.length,e)}),a.add("pop",function(e,t,n){c.fire("delete",h.length-1,1,t,n)}),a.add("shift",function(e,t,n){c.fire("delete",0,1,t,n)}),a.add("unshift",function(e,t,n){c.fire("insert",0,e)}),a.add("sort reverse",function(e,t,n){if(u)c.fire("clear"),c.fire("insert",h.length,n);else for(var i=0,r=t.length;r>i;i++){var o=n[i],a=t[i];if(o!==a){var f=t.indexOf(o,i),s=t.splice(f,1)[0];t.splice(i,0,s),c.fire("move",f,i)}}}),c.add("move",function(e,t){h[t].before(h[e]);var n=h.splice(e,1)[0];h.splice(t,0,n)}),c.add("clear",function(){c.fire("delete",0,h.length)}),c.fire("clear"),c.fire("insert",h.length,t),t.$event=a,!1}var f=t;e.each(f,function(e,t){if(!/^\$/.test(e)){var o=l.clone(),a=i,c={repeatObj:f};a["$item"+r]=t,c["$item"+r]=a["$index"+r]=e,n.deelNode(o,a,c),d.before(o),n.getChildNodes(o,a,r+1,c)}})})},getChildNodes:function(t,i,r,o){var a=e(t).contents(),c=[];r=r||0,a.length&&(a.each(function(t,a){var f=e(a),u=f.contents(),s=f.attr(n.prefix+"repeat");s?n.deelRepeat(a,i,r++,o):(n.deelNode(a,i,o),u.length&&c.push({node:a,vm:i}))}),c.length&&e.each(c,function(e,t){n.getChildNodes(t.node,t.vm,r,o)}))},converVbObj:function(t){var n=[],i=[],r="class_name_"+1*new Date,o="create_class_name_"+1*new Date;e.each(t,function(t,r){"function"===e.type(r)?n.push("Public ["+t+"]"):(n.push("Public [$key_"+t+"]"),n.push("Public [$old_$key_"+t+"]"),i.push(["","Public Property Let ["+t+"](strName)","[$key_"+t+"] = strName","Call ie_model_get_and_set("+o+', "'+t+'", 1, strName, [$old_$key_'+t+"])","[$old_$key_"+t+"] = strName","End Property","Public Property Set ["+t+"](strName)","Set [$key_"+t+"] = strName","Call ie_model_get_and_set("+o+', "'+t+'", 1, strName, [$old_$key_'+t+"])","Set [$old_$key_"+t+"] = strName","End Property","Public Property Get ["+t+"]()","	On Error Resume Next","		Set["+t+"] = [$key_"+t+"]","	If Err.Number <> 0 Then","["+t+"] = [$key_"+t+"]","	End If","	On Error Goto 0","Call ie_model_get_and_set("+o+', "'+t+'", 0)',"End Property"].join("\n")))}),window.execScript(["Class ["+r+"]",n.join("\n"),i.join("\n"),"End Class","set ["+o+"]=new ["+r+"]"].join("\n"),"vbscript");var a=window[o];return e.each(t,function(n,i){var r=i;if(i){var o=i.get,c=i.set;"function"===e.type(o)&&"function"===e.type(c)&&(r=o.call(t))}a[n]=r}),a},arrayBindEvent:function(t){var n="pop push shift unshift splice sort reverse concat slice".split(" ");e.each(n,function(e,n){if(n in Array.prototype){var i=Array.prototype[n];t[n]=function(){for(var e,t=[],r=0,o=this.length;o>r;r++)t[r]=this[r];return e=i.apply(this,arguments),this.$event&&this.$event.fire(n,arguments,t,this),e}}})},getExport:function(t,i){var r={},o=e.extend({},i);return r._=o,function a(t,i,r){if("object"==typeof r&&null!==r){var o=new n.Event,c={};if(r.$event=o,o.add("get",function(e,t){n.hasGet.push({obj:t,key:e})}),e.each(r,function(t,i){/^\$/.test(t)||("object"===e.type(r)&&(i&&i.get&&i.set?(n.addProp(r,t,i.get,i.set),c={obj:r,key:t,fnGet:i.get,fnSet:i.set}):(n.addProp(r,t),r[t]=i)),i&&i.get&&i.set||a(r,t,i))}),r.$watch&&e.each(r.$watch,function(e,t){o.add("watch."+e,t)}),"object"===e.type(r)){for(var f=0;10>f;f++){var u=f||"";n.addProp(r,"$item"+u),n.addProp(r,"$index"+u),r["$item"+u]=r["$index"+u]=null}if(c.obj&&(n.hasGet=[],c.fnGet.apply(r),e.each([].concat(n.hasGet),function(e,t){r.$event.add("watch."+t.key,function(){setTimeout(function(){r.$event.fire2(r,"fix.set."+c.key,[c.fnGet.apply(r),r[c.key]])},0)})})),n.ie678){var s=n.converVbObj(r);t[i]=s,c.obj&&(n.hasGet=[],c.fnGet.apply(s),e.each([].concat(n.hasGet),function(e,t){s.$event.add("watch."+t.key,function(){setTimeout(function(){s.$event.fire2(s,"vbscript.set."+c.key,[c.fnGet.apply(s),s[c.key]])},0)})}))}}}}(r,"_",o),n.deelNode(t,r._),n.getChildNodes(t,r._),r._},parseDeps:function(){var e=/"(?:\\"|[^"])*"|'(?:\\'|[^'])*'|\/\*[\S\s]*?\*\/|\/(?:\\\/|[^\/\r\n])+\/(?=[^\/])|\/\/.*|\.\s*require|(?:^|[^$])\brequire\s*\(\s*(["'])(.+?)\1\s*\)/g,t=/\\\\/g;return function(n){var i=[];return n.replace(t,"").replace(e,function(e,t,n){n&&i.push(n)}),i}}(),defineMap:{},defineEventMap:{},unique:function(t){var n={},i=[];return e.each(t,function(e,t){n[t]||(n[t]=!0,i.push(t))}),i},dim:function(i,r,o){var a=arguments,c=n.defineMap,f=n.defineEventMap;switch(a.length){case 0:return!1;case 1:o=i,r=[],i="anonymousId"+Math.random();break;case 2:"string"===e.type(i)?(o=r,r=[]):(o=r,r=i,i="anonymousId"+Math.random())}"functoin"===e.type(o)&&(r=r.concat(n.parseDeps(o.toString()))),r=n.unique(r),c[i]={id:i,deps:r,factory:o},f[i]||(f[i]=new t),r.forEach(function(e){f[e]||(f[e]=new t),f[i].add(function(){f[e].onEnd(function(){f[i].ok()})})}),e(function(){f[i].fire(function(){},function(){var t=c[i];t.exports={};var r,a=function(e){return c[e].exports},f=e("#"+i);f&&f.length?(r="function"===e.type(o)?o.apply(f,[a,t.exports,t])||t.exports:o,r=n.getExport(f.get(0),r),window.VMODELS[i]=r):r="function"===e.type(o)?o(a,t.exports,t)||t.exports:o,t.exports=r})})}};n.init(),e.dim=n.dim,e.mc=function(t,n){return n&&e.each(n,function(e,n){n&&n.call(self,t)}),t}};"function"==typeof define&&(define.amd||define.cmd)?define(function(t,n,i){var r=t("./jquery");e(r)}):e(jQuery)}();